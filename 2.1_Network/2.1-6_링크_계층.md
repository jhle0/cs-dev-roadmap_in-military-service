# 2.1-6 링크 계층

---

# 2.1–6 링크 계층 (Data Link Layer)

## 6.1 링크 계층 소개 (Introduction to the Data Link Layer)

### 링크 계층의 역할

- **링크 계층(Data Link Layer)** 은 **인접한 두 노드(한 홉)** 간의 데이터 전송을 담당한다.
- 상위 계층(네트워크 계층)이 IP 패킷을 생성하면, 링크 계층은 이를 **프레임(Frame)** 으로 캡슐화하여 전송한다.
- 프레임은 **헤더(제어 정보)** + **데이터(IP 패킷)** 으로 구성된다.
- 실제 통신은 “출발지 호스트 → 여러 링크 → 목적지 호스트” 순서로 이루어진다.
    
    각 링크마다 링크 계층 프로토콜이 개별적으로 동작한다.
    

### 링크 계층이 제공하는 서비스

1. **프레임화 (Framing)**
    - IP 데이터그램을 프레임으로 감싸 전송한다.
    - 프레임에는 데이터 외에도 송신자·수신자 주소(MAC)와 오류 검출 비트가 포함된다.
2. **링크 접근 제어 (Link Access, MAC Protocol)**
    - 여러 노드가 하나의 매체를 공유할 때 **누가 언제 전송할지**를 조정한다.
        - 매체 접속 프로토콜이 링크상으로 프레임을 전송하 ㄹ규칙을 명시한다
    - 점대점 링크(point-to-point)에서는 단순히 “비어 있으면 전송”.
    - 브로드캐스트 링크에서는 **충돌 방지(CSMA/CD 등)** 기능이 필요하다.
3. **신뢰적 전달 (Reliable Delivery)**
    - 오류 발생 시 **링크 단위에서 재전송**하거나 **ACK/NACK** 방식으로 확인한다.
    - 주로 무선 링크처럼 오류율이 높은 환경에서 사용된다.
    - 대부분의 유선 LAN(Ethernet)에서는 TCP가 신뢰성을 보장하므로 생략된다.
4. **오류 검출 및 정정 (Error Detection and Correction)**
    - 전송 중 잡음이나 신호 감쇠로 비트 오류가 발생할 수 있다.
    - 송신 측은 오류 검출 비트를 추가하고, 수신 측은 이를 검사한다.
    - 일반적으로 하드웨어(NIC) 수준에서 **CRC(Cyclic Redundancy Check)** 로 수행된다.
    - 일부 프로토콜은 오류 위치까지 찾아내 **정정(Correction)** 을 수행할 수 있다.

### 링크 계층의 구현 위치

- **네트워크 인터페이스 컨트롤러 (NIC, Network Interface Controller)(=네트워크 어댑터)**
    - 대부분의 링크 계층 기능은 하드웨어인 **네트워크 어댑터(Network Adapter)** 에 구현된다.
    - 송신 측 NIC: 메모리에 있는 데이터그램을 프레임으로 캡슐화 후 전송
    - 수신 측 NIC: 프레임을 받아 IP 데이터그램을 추출 후 상위 계층으로 전달
- **컨트롤러(Controller)**
    - 네트워크 어댑터 안 컨트롤러는 링크 계층 서비스가 구현된 특수 용도 칩이다.
    - 프레임화, 전송, 오류 검출 등의 기능이 하드웨어 수준에서 수행된다.
- **CPU와 소프트웨어 구성요소**
    - 일부 링크 계층 기능은 소프트웨어로 구현되어 CPU에서 처리된다.
    - 예: 주소 관리, 오류 처리, 컨트롤러 초기화, 데이터 전달 관리 등
---

## 6.2 오류 검출 및 정정 기술 (Error Detection and Correction)

### 개요

- 링크 계층에서는 전송 중 발생할 수 있는 **비트 손상**을 탐지하기 위해 **오류 검출(Error Detection)** 과 **정정(Error Correction)** 기능을 수행한다.
- 대부분의 경우 **하드웨어(NIC)** 가 자동으로 처리하며, 손상된 프레임은 상위 계층(TCP)으로 전달되지 않고 **폐기(drop)** 된다.

### 패리티 검사 (Parity Checking)

- 데이터에 **패리티 비트(1비트)** 를 추가해 1의 개수를 짝수 또는 홀수로 맞추는 방식.
- **단순한 오류 검출**만 가능하며, 짝수 개의 비트 오류는 탐지하지 못한다.
    - 오류가 2개면 그대로이므로 정상으로 나와 검출 X

### 체크섬 (Checksum Method)

- 데이터를 일정 단위로 나누어 모두 더한 뒤,
    
    **1의 보수(One’s Complement)** 값을 헤더에 저장한다.
    
- 수신 측은 데이터를 다시 더해 **모두 1이면 정상**, 그렇지 않으면 오류로 판단한다.
- **TCP/UDP 헤더에서 사용되는 방식**으로, 전송 도중 데이터 손상 여부를 감지한다.
- 소프트웨어 기반으로 수행되며, **CRC보다 검출 정확도는 낮다.**

### 순환 중복 검사 (Cyclic Redundancy Check, CRC)

- 링크 계층에서 가장 널리 쓰는 오류 검출 방식이다. 이더넷 프레임 끝에 붙는 4바이트 FCS(Frame Check Sequence)가 이 CRC 결과다.
- 송신 측은 전송할 비트열을 미리 합의된 **생성 다항식(Generator Polynomial, G)** 으로 나누고, 그때 생기는 나머지를 뒤에 붙여서 보낸다. 이 나머지가 CRC 코드다.
- 수신 측은 받은 전체 비트열을 같은 다항식으로 다시 나눈다. 나머지가 0이면 “전송 중 비트가 안 깨졌다”고 보고 통과시키고, 0이 아니면 오류로 보고 프레임을 버린다.
- 이 과정은 전부 2진수에서의 나눗셈(= XOR 연산)으로 이뤄지기 때문에 하드웨어로 구현하기 쉽다. 그래서 NIC 안에 전용 회로가 들어 있고 CPU가 신경 쓰지 않아도 된다.
- 잘 설계된 CRC는
    - 1비트 오류
    - 짧은 연속 오류(버스트 오류)
    - 대부분의 우연한 비트 뒤섞임
        
        을 매우 높은 확률로 잡아낸다.
        
- 이더넷은 보통 **CRC-32**를 쓰는데, 32비트 코드이기 때문에 우연히 못 잡을 확률이 아주 낮다.
- 중요한 점은 CRC가 “잡아낸다”까지이고, “고친다”까지는 아니다. 수신 NIC가 오류를 발견하면 그 프레임을 그냥 버리고, 손실 복구는 위쪽 계층(TCP 등)이 한다.

---
