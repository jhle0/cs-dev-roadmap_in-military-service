# 2.1-1. 네트워크 개요 & 성능 지표

> **Active recall**
> 
> - 인터넷을 **“망 안의 망(Network of Networks)”**이라고 부르는 이유를 한 줄로 말할 수 있다.
> - **호스트(End System)**, **링크(Link)**, **라우터(Router)**, **ISP** 각각의 역할을 한 줄 정의할 수 있다.
> - **회선 교환(Circuit Switching)**과 **패킷 교환(Packet Switching)**의 차이를 한 줄로 설명할 수 있다.
> - 네트워크 성능 지표 **지연(Latency), 대역폭(Bandwidth), 처리량(Throughput), Goodput, 손실률(Packet Loss), 지터(Jitter)**를 각각 한 줄로 정의할 수 있다.
> - 대역폭(Bandwidth)과 처리량(Throughput)의 차이를 **한 줄 비교**로 설명할 수 있다.

## 1.1 인터넷 구조 (Internet Structure)

- **호스트(Host, End System)**: 네트워크에 연결된 종단 장치 (PC, 스마트폰, 서버, IoT 기기 포함).
- **링크(Link)**: 호스트와 네트워크 장치를 연결하는 통신 경로 (유선: Ethernet/광케이블, 무선: Wi-Fi/5G).
- **라우터(Router)**: **목적지 IP 주소 기반으로** 패킷을 다른 네트워크로 포워딩하는 장치.
- **ISP(Internet Service Provider)**: 사용자를 인터넷에 연결해주는 서비스 제공자 (KT, SKT, Comcast 등).
- **계층 구조**:
    - Tier-1 ISP: 전 세계 백본(Backbone) 네트워크 운영
    - Tier-2 ISP: 국가·지역 단위
    - Tier-3 ISP: 최종 사용자 접속 제공 (우리 집 인터넷)

→ 인터넷은 **“망 안의 망 (network of networks)”** 구조다.

---

## 1.2 교환 방식 (Switching Techniques)

- **회선 교환(Circuit Switching)**: 통화처럼 **전용 회선 예약** 후 전송한다. 지연·품질 예측은 쉽지만 회선 낭비가 크다.
- **패킷 교환(Packet Switching)**: 데이터를 **패킷 단위로 쪼개** 필요한 순간에 자원을 공유하며 전송한다. (인터넷의 기본 방식)
- **Multiplexing(다중화) →** 여러 개의 데이터 흐름(트래픽)을 **하나의 물리적 통신 채널에 “겹쳐서”** 실어 보내는 기술
    - **FDM**: 주파수를 분할해 동시에 전송 (라디오/아날로그).
    - **TDM**: 시간을 슬롯으로 나누어 순차 전송 (디지털 전화망).
    - **Statistical Multiplexing**: 미리 시간/주파수를 고정하지 않고, 실제 사용량에 따라 동적으로 공유 (패킷 교환의 핵심).

→ 인터넷은 **패킷 교환 기반**이다.

---

## 1.3 네트워크 성능 지표

- **Latency(지연)**: 한쪽에서 다른 쪽으로 **패킷이 도달하는 시간(one-way)**.
    - **전송 지연(Transmission Delay)**: 패킷을 링크에 밀어 넣는 데 걸리는 시간 (= 패킷 크기 ÷ 전송 대역폭).
    - **전파 지연(Propagation Delay)**: 신호가 물리 매체를 따라 이동하는 시간 (= 거리 ÷ 전파 속도).
    - **처리 지연(Processing Delay)**: 라우터/호스트가 헤더 검사·오류 확인·라우팅 결정하는 시간.
    - **큐잉 지연(Queueing Delay)**: 혼잡 시 라우터 큐에 대기하는 시간 (네트워크 부하에 따라 달라짐).
- **RTT (Round Trip Time)**: 패킷 왕복 시간 (요청→응답 전체 시간).
- **대역폭(Bandwidth)**: 초당 전송 가능한 최대 비트 수 (bps).
- **처리량(Throughput)**: 실제로 측정된 전송 속도 (혼잡/손실에 영향 받음).
- **Goodput**: 처리량 중에서도 **진짜 유효 데이터(payload)**만 남긴 속도.
    - 관계: **Goodput ≤ Throughput ≤ Bandwidth**
- **손실률(Packet Loss)**: 전송 도중 유실되는 패킷 비율.
- **지터(Jitter)**: 패킷이 목적지에 도착하는 **시간 간격이 들쭉날쭉 변동하는 현상** (VoIP/화상회의 품질에 중요).

**→ 네트워크 성능 = 지연 + 대역폭 + 손실률 + 지터** 조합으로 평가한다.

---

## 1.4 QoS & 계측 (품질을 수치로 본다)

- **QoS 지표**: **지연, 지터, 손실률, 대역폭**을 바탕으로 네트워크 품질을 수치로 나타내는 지표.
- **Best-effort 모델**: 퍼블릭 인터넷은 QoS를 보장하지 않는다. (전용망/MPLS/5G 슬라이싱에서만 보장 가능)
- **계측 도구/지표**
    - **RTT**: `ping`으로 왕복 지연 확인.
    - **Traceroute/mtr**: 패킷이 어떤 경로(라우터들)를 거쳐가는지, 각 구간에서 지연이 몇 ms인지 보여줌.
    - **p95/p99 Latency**: 모든 요청의 응답 시간을 정렬했을 때, **상위 5% (p95), 상위 1% (p99)** 지연값.

---

## 1.5 중점: End-to-End 관점

- **E2E 원칙**: 네트워크 장비는 “단순 전달”만 담당. 신뢰성·암호화·복구는 **호스트(End System)**에서 처리한다.
- **예시**: TCP(재전송·순서 보장), TLS(암호화), HTTP(애플리케이션 로직).
- **개발자가 챙겨야 할 것**
    - **타임아웃 & 재시도(backoff)**
        - 네트워크는 항상 손실·지연 가능 → 무한히 기다리지 않고 **타임아웃**을 설정해야 함.
        - 재시도할 때는 바로 다시 보내지 말고, 점점 간격을 늘려주는 **지수적 backoff**가 필요.
        - 예: API 요청 → 1초 후 재시도, 실패하면 2초, 그다음 4초 …
    - **Goodput 최적화 (캐싱, 압축, HTTP 개선)**
        - **캐싱**: 같은 데이터 반복 요청을 줄임 (ex. 이미지, CSS, JS).
        - **압축**: Gzip, Brotli로 데이터 크기를 줄임.
        - **Keep-alive/HTTP2·3**: 매번 새 연결을 안 만들고, 하나의 연결로 여러 요청 처리 → 지연 줄임.
    - **대용량 전송 최적화**
        - **Chunk/Range 전송**: 큰 파일을 잘라서 부분적으로 전송. 중간에 끊겨도 이어받기 가능.
        - **Resume Upload**: 업로드하다 끊기면 처음부터 다시 안 하고 중단 지점부터 이어서 업로드.
        - → AWS S3, 구글 드라이브 업로드 같은 데서 많이 씀.
