# 1.1-9 인터럽트 & DMA

> **Active Recall**
> 
> - 인터럽트 처리 과정을 단계별로 설명할 수 있다.
> - 인터럽트 벡터와 인터럽트 서비스 루틴(ISR)의 역할을 설명할 수 있다.
> - 컨텍스트 스위칭이 무엇이며 왜 필요한지 설명할 수 있다.
> - 인터럽트 방식과 DMA 방식의 차이를 비교할 수 있다.
> - DMA가 CPU 성능 향상에 기여하는 이유를 설명할 수 있다.

## 1. 인터럽트(Interrupt)

### (1) 개념

- **정의**: CPU가 명령어를 실행하는 도중, **예상치 못한 외부 요청이나 이벤트**가 발생했을 때, 현재 작업을 잠시 멈추고 그 요청을 처리하는 메커니즘.
- 쉽게 말해: CPU가 "잠깐! 중요한 일이 생겼으니 먼저 처리하자" 하는 것.

---

### (2) 인터럽트 처리 과정

1. I/O 장치나 외부 장치가 **인터럽트 신호 발생**.
2. CPU는 현재 실행 중인 명령을 끝낸 후 → **현재 상태(PC, 레지스터)를 PCB(Process Control Block)에 저장**.
3. CPU는 **인터럽트 벡터(Interrupt Vector)**를 참고해 해당 인터럽트 서비스 루틴(ISR, 핸들러)으로 점프.
4. ISR 실행 후, 저장해둔 상태를 복구하고 원래 작업으로 복귀.

→ 즉, **컨텍스트 스위칭(Context Switching)** 과정이 일어난다고 보면 된다.

> **인터럽트 벡터 (Interrupt Vector)**
> 
> - 해당 인터럽트를 처리할 코드(함수)의 **시작 주소**를 저장해둔 테이블
> 
> **인터럽트 서비스 루틴 (Interrupt Service Routine, ISR)**
> 
> - 특정 인터럽트를 처리하기 위해 실행되는 **핸들러 함수**
> 
> **컨텍스트 스위칭(Context Switching)**
> 
> - CPU가 실행 중이던 프로세스/스레드를 멈추고, **다른 프로세스/스레드로 교체하는 과정**

---

### (3) 인터럽트 종류

- **하드웨어 인터럽트**: 키보드 입력, 마우스 클릭, I/O 완료, 타이머 등.
- **소프트웨어 인터럽트 (트랩, Trap)**: 예외 처리(0으로 나누기), 시스템 콜(운영체제 기능 요청).

---

## 2. DMA (Direct Memory Access)

### (1) 개념

- 보통 I/O 장치(디스크, 네트워크 카드 등)는 CPU를 거쳐 데이터를 RAM에 전달한다.
- 하지만 **DMA 컨트롤러**가 있으면, CPU를 거치지 않고 **I/O 장치 ↔ 메모리 간 직접 전송**이 가능하다.
- CPU는 "데이터 복사" 같은 반복 작업에서 해방되고, 다른 연산에 집중 가능.

---

### (2) DMA 동작 과정

- CPU가 DMA 컨트롤러에게 "이 장치에서 메모리로 데이터를 N바이트 복사해라" 라고 명령.
- DMA 컨트롤러가 I/O 장치 ↔ 메모리 간 데이터 전송 수행.
    - 이때 DMA는 **버스(주소/데이터/제어 버스)**를 직접 사용한다.
    - CPU와 버스 충돌을 피하기 위해 **사이클 스틸링(Cycle Stealing)** 기법을 사용 → CPU 실행 사이클을 잠시 차단하고 데이터를 전송.
- 전송이 끝나면 DMA가 CPU에게 **인터럽트**로 알려줌 ("작업 완료!").

---

### (3) DMA 장점

- CPU 부하 감소 → 시스템 성능 향상.
- 대량 데이터(I/O-bound 작업)에서 특히 효과적 (예: 디스크 읽기, 네트워크 패킷 전송).
- CPU는 I/O 대기 없이 다른 연산을 동시에 진행 가능.

---

## 3. 인터럽트 vs DMA

| 구분 | 인터럽트 | DMA |
| --- | --- | --- |
| 개념 | CPU가 외부 요청을 받아 즉시 처리 | I/O 장치가 메모리에 직접 접근 |
| CPU 역할 | 요청마다 개입해 처리 | 시작 지시 후, 완료 시점에만 개입 |
| 적합한 경우 | 소량 작업, 이벤트 처리 | 대용량 데이터 전송 |
| 처리 방식 | ISR 실행 (컨텍스트 스위칭 발생) | DMA 컨트롤러가 직접 전송, 완료 후 인터럽트 |

---

# 4. 활용 예시

- **인터럽트**:
    - 키보드 입력 처리 (OS 커널이 인터럽트 벡터 테이블 통해 ISR 실행).
    - 네트워크 패킷 도착 시 알림.
- **DMA**:
    - 그래픽 카드가 대량 텍스처 데이터를 메모리에 직접 로딩.
    - SSD에서 데이터를 읽어 RAM으로 복사할 때 CPU 개입 최소화.
